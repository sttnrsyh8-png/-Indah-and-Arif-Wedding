<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Indah & Arif ‚Äî Wedding Invitation</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #fffdf8;
      --accent: #b4955a;
      --gold: #d4af37;
      --muted: #7a6f63;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(180deg,var(--bg),#fbf7ef 60%);
      color:#2b2b2b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    header{
      text-align:center;
      padding:48px 20px;
    }
    header h1{
      margin:0;
      font-family: 'Playfair Display', serif;
      font-size:48px;
      color:var(--accent);
      letter-spacing:1px;
    }
    header p.lead{
      margin:8px 0 0;
      color:var(--muted);
    }

    /* Book container */
    .book-wrap{
      max-width:980px;
      margin: 20px auto;
      perspective: 1400px;
      padding: 30px 18px;
    }

    .book {
      width: 100%;
      height: 420px;
      margin: 0 auto;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 900ms cubic-bezier(.2,.9,.3,1);
      transform-origin: 50% 50%;
    }

    /* pages */
    .page {
      position: absolute;
      top:0; left:0;
      width:100%;
      height:100%;
      background: linear-gradient(180deg,#fff 0%, #fff7f0 100%);
      border-radius: 14px;
      box-shadow: 0 10px 30px rgba(20,20,20,0.08);
      overflow: hidden;
      display: grid;
      grid-template-columns: 1fr 1fr;
      align-items: center;
      padding: 36px;
      backface-visibility: hidden;
    }

    /* left & right page styling */
    .page .side {
      padding: 10px 22px;
      min-height: 100%;
      display:flex;
      flex-direction: column;
      justify-content: center;
      gap: 12px;
    }

    .side .title {
      font-family: 'Playfair Display', serif;
      color: var(--accent);
      font-size: 22px;
      margin-bottom: 6px;
    }
    .side .sub {
      color: var(--muted);
      font-size: 14px;
    }

    /* cover spine to emphasize book look */
    .spine {
      position:absolute;
      left:calc(50% - 8px);
      top:16px;
      bottom:16px;
      width:16px;
      background: linear-gradient(180deg,#efe6d0,#f8f2e6);
      border-radius: 4px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
      z-index: 8;
    }

    /* Open animation classes */
    .book.open-left { transform: rotateY(-12deg) translateZ(-10px); }
    .book.open-right { transform: rotateY(12deg) translateZ(-10px); }

    /* page details ‚Äî positions for bride/groom layout */
    .bride-block { order: 1; align-items: flex-start; }
    .bride-name { font-size: 20px; font-weight:600; color:var(--accent); }
    .bride-illustration { display:flex; justify-content:flex-end; margin-left:8px; }

    .groom-block { order: 2; align-items: flex-end; }
    .groom-name { font-size: 20px; font-weight:600; color:var(--accent); text-align:right; }
    .groom-illustration { display:flex; justify-content:flex-start; margin-right:8px; }

    /* subtle page inner decoration */
    .page::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background-image: radial-gradient(white 1px, transparent 1px);
      background-size: 24px 24px;
      opacity:0.03;
    }

    /* controls */
    .controls{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-top:14px;
      align-items:center;
    }
    .btn{
      border: none;
      background: var(--gold);
      color:white;
      padding:8px 14px;
      border-radius:24px;
      cursor:pointer;
      font-weight:600;
    }
    .btn.secondary{
      background:transparent;
      border:1px solid rgba(0,0,0,0.06);
      color:var(--muted);
    }

    /* details & guestbook */
    section.details {
      max-width:860px;
      margin: 28px auto;
      padding: 22px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.05);
    }
    section.details h2{
      margin-top:0;
      color:var(--accent);
      font-family: 'Playfair Display', serif;
    }
    .row { display:flex; gap:18px; flex-wrap:wrap; }
    .col { flex:1 1 250px; min-width:220px; }

    /* guestbook */
    .guestbook{
      max-width:860px;
      margin: 20px auto 80px;
      background:#fff;
      padding:16px;
      border-radius:12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.04);
    }
    .guestbook h3{ margin:0; color:var(--accent); font-family: 'Playfair Display', serif; }
    input, textarea { width:100%; padding:10px; margin-top:8px; border-radius:8px; border:1px solid #e7e2d9; font-family:inherit; }
    button.send { margin-top:10px; background:var(--gold); color:white; border:none; padding:10px 16px; border-radius:20px; cursor:pointer; font-weight:600; }
    .message { border-bottom:1px dashed #f0ebe2; padding:10px 0; }
    .message strong { color:var(--accent); display:block; }

    /* responsive */
    @media (max-width:840px){
      .book { height: 360px; }
      .page { padding:20px; grid-template-columns: 1fr; grid-auto-rows: 1fr; gap:8px; }
      .spine { left: 50%; transform: translateX(-50%); }
      .bride-block, .groom-block { align-items:center; text-align:center; }
      .groom-name { text-align:center; }
      .bride-illustration, .groom-illustration { justify-content:center; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Indah & Arif</h1>
    <p class="lead">3 Desember 2025 ‚Äî ‚ÄúMaha suci Allah yang telah menciptakan makhluk-Nya berpasang-pasangan.‚Äù</p>
  </header>

  <div class="book-wrap" aria-hidden="false">
    <div class="book" id="book">
      <!-- left page -->
      <div class="page" id="leftPage" style="z-index:5;">
        <div class="side bride-block" aria-label="Bride info">
          <div>
            <div class="title">Mempelai Wanita</div>
            <div class="bride-name">Indah Sitti Nur Aisyah</div>
            <div class="sub">Putri dari Bapak A. Basri & Ibu Siti</div>
          </div>
        </div>
        <div class="side bride-illustration" aria-hidden="true">
          <!-- Soft-cartoon bride SVG (replaceable with Pixabay/Freepik image link if you prefer) -->
          <svg width="220" height="260" viewBox="0 0 220 260" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Bride illustration">
            <defs>
              <linearGradient id="skin" x1="0" x2="0" y1="0" y2="1">
                <stop offset="0" stop-color="#f6d6c7"/>
                <stop offset="1" stop-color="#f0c9b8"/>
              </linearGradient>
              <linearGradient id="hair" x1="0" x2="1">
                <stop offset="0" stop-color="#6b4a3a"/>
                <stop offset="1" stop-color="#3e2b23"/>
              </linearGradient>
            </defs>
            <!-- dress background -->
            <ellipse cx="110" cy="210" rx="80" ry="28" fill="#fff6f8" />
            <!-- body -->
            <path d="M60 140c12-40 88-40 100 0v66H60z" fill="#fff" stroke="#f2e9e6" stroke-width="1"/>
            <!-- head -->
            <circle cx="110" cy="80" r="30" fill="url(#skin)"/>
            <!-- hair -->
            <path d="M80 70c8-22 62-22 80 0v20c-18-12-62-12-80 0z" fill="url(#hair)"/>
            <!-- veil -->
            <path d="M68 62c22-14 84-14 108 0v120c-34 14-76 14-108 0z" fill="rgba(255,255,255,0.85)"/>
            <!-- bouquet -->
            <g transform="translate(130,170)">
              <ellipse cx="0" cy="0" rx="22" ry="18" fill="#fde1e8"/>
              <rect x="-8" y="10" width="16" height="30" rx="4" fill="#d1b8b8"/>
            </g>
          </svg>
        </div>
      </div>

      <!-- right page -->
      <div class="page" id="rightPage" style="z-index:3;">
        <div class="side groom-illustration" aria-hidden="true">
          <!-- Soft-cartoon groom SVG (replaceable) -->
          <svg width="210" height="260" viewBox="0 0 210 260" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Groom illustration">
            <defs>
              <linearGradient id="skin2" x1="0" x2="0" y1="0" y2="1">
                <stop offset="0" stop-color="#f6d6c7"/>
                <stop offset="1" stop-color="#f0c9b8"/>
              </linearGradient>
            </defs>
            <ellipse cx="105" cy="210" rx="72" ry="26" fill="#f7f7f7" />
            <path d="M55 140c12-40 74-40 86 0v66H55z" fill="#f3f3f5"/>
            <circle cx="105" cy="78" r="30" fill="url(#skin2)"/>
            <path d="M82 70c10-18 56-18 68 0v18c-14-10-54-10-68 0z" fill="#2f2f2f"/>
            <!-- suit -->
            <path d="M60 150c12-22 86-22 98 0v40H60z" fill="#22232a"/>
            <rect x="88" y="120" width="36" height="20" rx="3" fill="#fff"/>
            <circle cx="106" cy="140" r="3" fill="#d4af37"/>
          </svg>
        </div>

        <div class="side groom-block" aria-label="Groom info">
          <div style="width:100%;">
            <div class="title">Mempelai Pria</div>
            <div class="groom-name">Arif Rahman</div>
            <div class="sub">Putra dari Bapak H. Rahman & Ibu Nur</div>
          </div>
        </div>
      </div>

      <div class="spine" aria-hidden="true"></div>
    </div>

    <div class="controls" style="margin-top:14px;">
      <button class="btn" id="openBtn">Buka Buku</button>
      <button class="btn secondary" id="closeBtn">Tutup Buku</button>
      <button class="btn secondary" id="toggleMusic">Pause Music</button>
    </div>
  </div>

  <!-- event details -->
  <section class="details" aria-label="Wedding details">
    <h2>Wedding Details</h2>
    <div class="row">
      <div class="col">
        <strong>Akad Nikah</strong>
        <p>3 Desember 2025 ‚Äî 11.00 WIB</p>
      </div>
      <div class="col">
        <strong>Resepsi</strong>
        <p>11.00 WIB ‚Äî Selesai</p>
      </div>
      <div class="col">
        <strong>Venue</strong>
        <p>Jl. Poros Kulampu-Solo, Dusun Aluppange, Desa Alewadeng, Kec. Sajoanging, Kab. Wajo<br>
        <a href="https://maps.app.goo.gl/52bUetkWoo8VFB3g8" target="_blank" rel="noopener">üìç Open Google Maps</a></p>
      </div>
    </div>
  </section>

  <!-- guestbook -->
  <section class="guestbook" aria-label="Guestbook">
    <h3>Guest Wishes</h3>
    <form id="wishForm" style="margin-top:10px;">
      <input type="text" id="name" placeholder="Your name" required />
      <textarea id="message" rows="3" placeholder="Write your wishes..." required></textarea>
      <button class="send" type="submit">Send</button>
    </form>
    <div id="messages" style="margin-top:12px;"></div>
    <small style="color:#8a7f72; display:block; margin-top:8px;">Ucapan terbaru akan muncul di bawah.</small>
  </section>

  <script>
    // ---------- Music (keeps playing across navigations using sessionStorage) ----------
    const audio = new Audio("hsoft-piano-music-10-minutes-long-231315.mp3?filename=soft-piano-music-10-minutes-long-231315.mp3");
    audio.loop = true;
    audio.volume = 0.72;

    // load saved state
    const musicState = sessionStorage.getItem('musicPlaying') === 'true';
    const musicTime = parseFloat(sessionStorage.getItem('musicTime')) || 0;

    if (musicState) {
      audio.currentTime = musicTime;
      playAudio().catch(()=>{ /* autoplay prevented ‚Äî user can press button */ });
    }

    // update sessionStorage periodically (for continuity when leaving page)
    setInterval(() => {
      if (!isNaN(audio.currentTime)) sessionStorage.setItem('musicTime', audio.currentTime.toString());
    }, 1500);

    function playAudio(){
      return audio.play().then(()=> {
        sessionStorage.setItem('musicPlaying','true');
        document.getElementById('toggleMusic').innerText = 'Pause Music';
      });
    }
    function pauseAudio(){
      audio.pause();
      sessionStorage.setItem('musicPlaying','false');
      document.getElementById('toggleMusic').innerText = 'Play Music';
    }

    document.getElementById('toggleMusic').addEventListener('click', ()=>{
      if (audio.paused) playAudio(); else pauseAudio();
    });

    // ---------- Book open/close animation ----------
    const book = document.getElementById('book');
    const openBtn = document.getElementById('openBtn');
    const closeBtn = document.getElementById('closeBtn');

    openBtn.addEventListener('click', () => {
      // gentle 3D open: rotate both sides slightly
      book.classList.add('open-right');
      book.classList.add('open-left'); // small double class to emphasize
      // small timeout to remove one class for subtle effect
      setTimeout(()=> book.classList.remove('open-left'), 700);
    });
    closeBtn.addEventListener('click', () => {
      book.classList.remove('open-right');
      book.classList.remove('open-left');
    });

    // Open initially with small delay for effect
    setTimeout(()=> openBtn.click(), 600);

    // ---------- Guestbook using JSONBin (placeholder) ----------
    // NOTE: you must replace binId and apiKey with your jsonbin.io bin; or use another backend
    const binId = "YOUR_JSONBIN_ID";
    const apiKey = "YOUR_API_KEY"; // if private, otherwise empty
    const headers = apiKey ? { "Content-Type":"application/json", "X-Master-Key": apiKey } : { "Content-Type":"application/json" };

    async function loadMessages(){
      const container = document.getElementById('messages');
      container.innerHTML = '<p style="color:#8a7f72">Loading messages‚Ä¶</p>';
      if (!binId || binId === "YOUR_JSONBIN_ID") {
        container.innerHTML = '<p style="color:#8a7f72">Belum ada penyimpanan pesan. Ganti <code>binId</code> pada script agar kolom ucapan tersimpan.</p>';
        return;
      }

      try {
        const res = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, { headers });
        if (!res.ok) throw new Error('fetch failed');
        const data = await res.json();
        const messages = Array.isArray(data.record) ? data.record : [];
        if (!messages.length) container.innerHTML = '<p style="color:#8a7f72">Belum ada ucapan. Jadi yang pertama ya üíï</p>';
        else {
          container.innerHTML = '';
          messages.forEach(m => {
            const div = document.createElement('div');
            div.className = 'message';
            const time = m.time ? `<span style="font-size:12px;color:#9b9488">${new Date(m.time).toLocaleString()}</span>` : '';
            div.innerHTML = `<strong>${escapeHtml(m.name)}</strong>${time}<div style="margin-top:6px;">${escapeHtml(m.text)}</div>`;
            container.appendChild(div);
          });
        }
      } catch (err) {
        container.innerHTML = '<p style="color:#c06">Gagal memuat ucapan ‚Äî cek konfigurasi (binId/apiKey).</p>';
        console.error(err);
      }
    }

    document.getElementById('wishForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const text = document.getElementById('message').value.trim();
      if (!name || !text) return;
      if (!binId || binId === "YOUR_JSONBIN_ID") {
        alert('Silakan konfigurasikan binId API (jsonbin.io) pada script untuk menyimpan ucapan.');
        return;
      }
      try {
        // fetch current
        const res = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, { headers });
        const data = await res.json();
        const current = Array.isArray(data.record) ? data.record : [];
        current.push({ name, text, time: new Date().toISOString() });
        // update bin
        await fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
          method: "PUT",
          headers,
          body: JSON.stringify(current)
        });
        document.getElementById('wishForm').reset();
        loadMessages();
      } catch (err) {
        alert('Gagal mengirim ucapan. Cek console untuk detail.');
        console.error(err);
      }
    });

    // simple escape to avoid injection in innerHTML
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (m) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    loadMessages();

    // ---------- Save audio play/paused state when page is hidden/unloaded ----------
    document.addEventListener('visibilitychange', ()=> {
      if (document.hidden) {
        sessionStorage.setItem('musicTime', audio.currentTime || 0);
      }
    });
    window.addEventListener('beforeunload', ()=> {
      sessionStorage.setItem('musicTime', audio.currentTime || 0);
    });

    // Try to play once on any user interaction (some browsers block autoplay)
    function userPlayAttempt(){
      if (sessionStorage.getItem('musicPlaying') === 'true') {
        playAudio().catch(()=>{/* ignore */});
      }
      window.removeEventListener('click', userPlayAttempt);
      window.removeEventListener('keydown', userPlayAttempt);
      window.removeEventListener('touchstart', userPlayAttempt);
    }
    window.addEventListener('click', userPlayAttempt);
    window.addEventListener('keydown', userPlayAttempt);
    window.addEventListener('touchstart', userPlayAttempt);

  </script>
</body>
</html>
